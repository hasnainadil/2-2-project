CREATE OR REPLACE PROCEDURE "LOGIN" (EMAIL IN VARCHAR2,PASS IN VARCHAR2,STATUS OUT VARCHAR2,id out NUMBER,first_name out VARCHAR2, last_name out VARCHAR2,email_address out VARCHAR2,reg_date out VARCHAR2,profile_pic out VARCHAR2) AS
HASHED_PASS VARCHAR2(100);
USER_PASS VARCHAR2(100);
BEGIN
SELECT PASSWORD INTO USER_PASS FROM USERS WHERE EMAIL_ADDRESS = EMAIL;
select a.USER_ID,a.first_name,a.LAST_NAME,a.EMAIL_ADDRESS, a.REGISTRATION_DATE,a.PROFILE_PICTURE INTO id,first_name, last_name,email_address,reg_date, profile_pic
         from USERS a 
         WHERE EMAIL_ADDRESS = EMAIL;
 DBMS_OUTPUT.PUT_LINE(USER_PASS);
 HASHED_PASS := dbms_crypto.hash (utl_i18n.string_to_raw (PASS, 'AL32UTF8'), dbms_crypto.hash_sh1);
 IF USER_PASS = HASHED_PASS THEN 
 STATUS := 'SUCCESSFUL';
 ELSE
 STATUS := 'NOT MATCHED';
 END IF;
 EXCEPTION
 WHEN NO_DATA_FOUND THEN
 STATUS := 'USER NOT FOUND';
 WHEN OTHERS THEN
 STATUS := 'UNKNOWN ERROR';
end;
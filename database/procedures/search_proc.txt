CREATE OR REPLACE PROCEDURE "search_proc"(search in VARCHAR2,cursor out sys_refcursor) AS
BEGIN
OPEN cursor FOR 
			SELECT RECIPE_ID, TITLE, (SELECT (FIRST_NAME||' '||LAST_NAME) AS NAME FROM USERS WHERE USER_ID = R.USER_ID) as PUBLISHER_NAME,TO_CHAR(CREATION_DATE,'DD/MON/YY') CREATION_DATE , COOKING_INSTRUCTION ,AVERAGE_RATING(RECIPE_ID) as RATING
		FROM RECIPES R
		WHERE LOWER(TITLE) LIKE '%'||LOWER(search)||'%'
		ORDER BY TITLE;
	
END;
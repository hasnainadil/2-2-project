CREATE TABLE Users (
   user_id           NUMBER(10) NOT NULL PRIMARY KEY,
   first_name        VARCHAR2(30) NOT NULL,
   last_name         VARCHAR2(30) NOT NULL,
   email_address     VARCHAR2(40) NOT NULL UNIQUE,
   password          VARCHAR2(100) NOT NULL,
   profile_picture   VARCHAR2(255),
   registration_date DATE NOT NULL
);
CREATE TABLE Categories (
   category_id NUMBER(10) PRIMARY KEY,
   name        VARCHAR2(30) NOT NULL
);
CREATE TABLE Recipes (
   recipe_id           NUMBER(10) PRIMARY KEY,
   title               VARCHAR2(80) NOT NULL,
   cooking_instruction VARCHAR2(1000) NOT NULL,
   preparation_time    NUMBER(5) NOT NULL,
   cooking_time        NUMBER(5) NOT NULL,
   user_id             NUMBER(5) NOT NULL,
   creation_date       DATE NOT NULL,
   modification_date   DATE,
   FOREIGN KEY (user_id) REFERENCES Users(user_id)
);
CREATE TABLE Categorizes (
   recipe_id       NUMBER(10) NOT NULL,
   category_id     NUMBER(10) NOT NULL,
   PRIMARY KEY (recipe_id, category_id),
   FOREIGN KEY (recipe_id) REFERENCES Recipes (recipe_id),
   FOREIGN KEY (category_id) REFERENCES Categories (category_id)
);
CREATE TABLE Shopping_Lists(
   list_id       NUMBER(10) PRIMARY KEY,
   user_id       NUMBER(10) NOT NULL,
   list_name     VARCHAR2(150) NOT NULL,
   creation_date DATE NOT NULL,
   FOREIGN KEY (user_id) REFERENCES Users(user_id)
);
CREATE TABLE Reviews(
   review_id   NUMBER(10) NOT NULL PRIMARY KEY 
  ,user_id     NUMBER(10) NOT NULL
  ,recipe_id   NUMBER(10) NOT NULL
  ,rating      NUMBER(1) NOT NULL
  ,review_date DATE NOT NULL
  ,Comments    VARCHAR2(300) NOT NULL
  ,FOREIGN KEY (user_id) REFERENCES Users(user_id)
  ,FOREIGN KEY (recipe_id) REFERENCES Recipes(recipe_id)
);
CREATE TABLE Ingredients(
   ingredient_id NUMBER(10) NOT NULL PRIMARY KEY 
  ,name          VARCHAR2(100) NOT NULL UNIQUE
  ,calories      NUMBER(8,4) NOT NULL
  ,protein       NUMBER(8,4) NOT NULL
  ,carbohydrate  NUMBER(8,4) NOT NULL
  ,fat           NUMBER(8,4) NOT NULL
  ,fiber         NUMBER(8,4) NOT NULL
);
CREATE TABLE Shops (
   list_id       NUMBER(10) NOT NULL,
   ingredient_id NUMBER(10) NOT NULL,
   quantity      NUMBER,
   PRIMARY KEY (list_id, ingredient_id),
   FOREIGN KEY (list_id) REFERENCES Shopping_Lists (list_id),
   FOREIGN KEY (ingredient_id) REFERENCES Ingredients (ingredient_id)
);
CREATE TABLE Recipe_Ingredients (
   recipe_id       NUMBER(10) NOT NULL,
   ingredient_id   NUMBER(10) NOT NULL,
   quantity        NUMBER,
   PRIMARY KEY (recipe_id, ingredient_id),
   FOREIGN KEY (recipe_id) REFERENCES Recipes (recipe_id),
   FOREIGN KEY (ingredient_id) REFERENCES Ingredients (ingredient_id)
);
CREATE TABLE Tags (
   tag_id      NUMBER(10) PRIMARY KEY,
   name        VARCHAR2(30) NOT NULL,
   description VARCHAR2(200) NOT NULL
);
CREATE TABLE Favourite(
   user_id   NUMBER(10) NOT NULL,
   recipe_id NUMBER(10) NOT NULL,
   PRIMARY KEY (user_id, recipe_id),
   FOREIGN KEY (user_id) REFERENCES Users(user_id),
   FOREIGN KEY (recipe_id) REFERENCES Recipes(recipe_id)
);
CREATE TABLE Dietary_Restrictions(
   dietary_id  NUMBER(5) NOT NULL PRIMARY KEY,
   restriction VARCHAR2(50) NOT NULL
);
CREATE TABLE User_Dietary_Restrictions (
   dietary_id   NUMBER(5) NOT NULL,
   user_id      NUMBER(10) NOT NULL,
   PRIMARY KEY (dietary_id, user_id),
   FOREIGN KEY (dietary_id) REFERENCES Dietary_Restrictions (dietary_id),
   FOREIGN KEY (user_id) REFERENCES Users (user_id)
);
CREATE TABLE Substitutions (
   original_ingredient_id      NUMBER(10) NOT NULL,
   substitute_ingredient_id    NUMBER(10) NOT NULL,
   PRIMARY KEY (original_ingredient_id, substitute_ingredient_id),
   FOREIGN KEY (original_ingredient_id) REFERENCES Ingredients (ingredient_id),
   FOREIGN KEY (substitute_ingredient_id) REFERENCES Ingredients (ingredient_id)
);
CREATE TABLE Recipe_Tags (
   recipe_id   NUMBER(10) NOT NULL,
   tag_id      NUMBER(10) NOT NULL,
   PRIMARY KEY (recipe_id, tag_id),
   FOREIGN KEY (recipe_id) REFERENCES Recipes (recipe_id),
   FOREIGN KEY (tag_id) REFERENCES Tags (tag_id)
);
CREATE TABLE Media (
   media_id     NUMBER(10) PRIMARY KEY,
   recipe_id    NUMBER(10) NOT NULL,
   image        VARCHAR2(255),
   video_url    VARCHAR2(255),
   FOREIGN KEY (recipe_id) REFERENCES Recipes (recipe_id)
);
CREATE TABLE Meal_Plans (
   plan_id        NUMBER(10) PRIMARY KEY,
   user_id        NUMBER(10) NOT NULL,
   plan_name      VARCHAR2(255),
   creation_date  DATE,
   duration       DATE,
   FOREIGN KEY (user_id) REFERENCES Users (user_id)
);
CREATE TABLE Meal_Plan_Recipes (
   plan_id     NUMBER(10) NOT NULL,
   recipe_id   NUMBER(10) NOT NULL,
   meal_slot   VARCHAR2(50),
   PRIMARY KEY (plan_id, recipe_id),
   FOREIGN KEY (plan_id) REFERENCES Meal_Plans (plan_id),
   FOREIGN KEY (recipe_id) REFERENCES Recipes (recipe_id)
);
CREATE TABLE notifications (
    notification_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    user_id NUMBER NOT NULL,
    message VARCHAR2(255 CHAR) NOT NULL,
    notification_type VARCHAR2(20),
    R_U_ID NUMBER(10),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    is_read NUMBER(1,0) DEFAULT 0,
    PRIMARY KEY (notification_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);


CREATE OR REPLACE FUNCTION AVERAGE_RATING(R_ID NUMBER) RETURN NUMBER IS
  AVG_RATING NUMBER;

BEGIN
  SELECT ROUND(AVG(RV.RATING), 1) INTO AVG_RATING
  FROM REVIEWS RV
  WHERE RECIPE_ID = R_ID;

  RETURN AVG_RATING;

EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE('NO DATA!');
    RETURN 0;
  WHEN TOO_MANY_ROWS THEN
    DBMS_OUTPUT.PUT_LINE('MULTIPLE DATA!');
    RETURN 9;
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('UNKNOWN ERROR!');
    RETURN -1;
END;
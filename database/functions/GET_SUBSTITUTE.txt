CREATE OR REPLACE FUNCTION GET_SUBSTITUTE (I_NAME VARCHAR2) RETURN VARCHAR2 IS
    SUBSTITUTE_INGREDIENT VARCHAR2(50);
BEGIN
    SELECT I.NAME INTO SUBSTITUTE_INGREDIENT
    FROM INGREDIENTS I
    JOIN SUBSTITUTIONS S ON (S.SUBSTITUTE_INGREDIENT_ID = I.INGREDIENT_ID)
    WHERE S.ORIGINAL_INGREDIENT_ID = (SELECT I2.INGREDIENT_ID FROM INGREDIENTS I2 WHERE TRIM(I2.NAME) LIKE TRIM(I_NAME));

    RETURN SUBSTITUTE_INGREDIENT;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        SUBSTITUTE_INGREDIENT := 'NO DATA!';
        DBMS_OUTPUT.PUT_LINE('NO DATA!');
        RETURN SUBSTITUTE_INGREDIENT;
    WHEN TOO_MANY_ROWS THEN
        SUBSTITUTE_INGREDIENT := 'MULTIPLE DATA!';
        DBMS_OUTPUT.PUT_LINE('MULTIPLE DATA!');
        RETURN SUBSTITUTE_INGREDIENT;
    WHEN OTHERS THEN
        SUBSTITUTE_INGREDIENT := 'UNKNOWN ERROR!';
        DBMS_OUTPUT.PUT_LINE('UNKNOWN ERROR!');
        RETURN SUBSTITUTE_INGREDIENT;
END;